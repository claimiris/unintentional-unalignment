Filtered out 1 experiments in which the training loss increased at some time step
========================================================================================================
Experiment info outputs/persona/olmo1b_post_sft_dpo_no_vs_never:
--------------------------------------------------------------------------------------------------------
Model: allenai/OLMo-1B-hf
Model checkpoint: outputs/persona_models/olmo1b_sft_persona_cross_entropy_2025_12_15-19_17_03/model_epoch_0
Dataset: data_files/persona/ends-justify-means.jsonl
Preferred output token: 'No'
Dispreferred output token: 'Never'
========================================================================================================

========================================================================================================
Preferred output probability decrease results:
--------------------------------------------------------------------------------------------------------
First step preferred output probability decreased: Min: 2 , Max: 5 , Median: 3 , Mean: 3.222222328186035
--------------------------------------------------------------------------------------------------------
Number of examples in which preferred output probability decreased: 9 / 9
--------------------------------------------------------------------------------------------------------
Number of examples in which preferred output probability decreased and train loss decreased: 9 / 9
--------------------------------------------------------------------------------------------------------
Number of examples in which train loss INCREASED: 0 / 9
========================================================================================================

========================================================================================================
Max preferred output probability and log probability decrease results:
--------------------------------------------------------------------------------------------------------
Mean largest preferred output log probability decrease (step refers to value before that step): -0.07213899493217468 (-0.004349284805357456 -> -0.07648828625679016)
Mean start step: 4.222222328186035 , Mean end step: 31.77777862548828
--------------------------------------------------------------------------------------------------------
Mean largest preferred output probability decrease (step refers to value before that step): -0.06906389445066452 (0.995661735534668 -> 0.9265978336334229)
Mean start step: 4.222222328186035 , Mean end step: 31.77777862548828
========================================================================================================

========================================================================================================
Per example max preferred output probability and log probability decrease results
========================================================================================================
Example 0
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 5 to 100: -0.06656885147094727 (-0.0037834644317626953 -> -0.07035231590270996)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 5 to 100: -0.06415832042694092 (0.9962236881256104 -> 0.9320653676986694)
========================================================================================================
Example 1
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 3 to 15: -0.08019065856933594 (-0.002333402633666992 -> -0.08252406120300293)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 3 to 15: -0.07688003778457642 (0.9976693391799927 -> 0.9207893013954163)
========================================================================================================
Example 2
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 3 to 5: -0.08356690406799316 (-0.007392406463623047 -> -0.09095931053161621)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 3 to 5: -0.07957994937896729 (0.9926348328590393 -> 0.913054883480072)
========================================================================================================
Example 3
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 3 to 4: -0.1269979476928711 (-0.0033905506134033203 -> -0.13038849830627441)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 3 to 4: -0.11886078119277954 (0.9966151714324951 -> 0.8777543902397156)
========================================================================================================
Example 4
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 5 to 19: -0.06677603721618652 (-0.003233671188354492 -> -0.07000970840454102)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 5 to 19: -0.06438684463500977 (0.9967715740203857 -> 0.932384729385376)
========================================================================================================
Example 5
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 5 to 18: -0.055158376693725586 (-0.0053670406341552734 -> -0.06052541732788086)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 5 to 18: -0.053377509117126465 (0.9946473240852356 -> 0.9412698149681091)
========================================================================================================
Example 6
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 4 to 6: -0.05850934982299805 (-0.0028548240661621094 -> -0.061364173889160156)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 4 to 6: -0.05666857957839966 (0.9971492290496826 -> 0.940480649471283)
========================================================================================================
Example 7
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 5 to 19: -0.06806564331054688 (-0.0072748661041259766 -> -0.07534050941467285)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 5 to 19: -0.06532388925552368 (0.9927515387535095 -> 0.9274276494979858)
========================================================================================================
Example 8
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 5 to 100: -0.04341721534729004 (-0.003513336181640625 -> -0.046930551528930664)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 5 to 100: -0.04233914613723755 (0.9964928030967712 -> 0.9541536569595337)
========================================================================================================


========================================================================================================
Tokens increasing most overall in probability:
--------------------------------------------------------------------------------------------------------
Overall Top-1 probability increase token counts at time step 1:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 9 , frequency: 1.000 , mean increase: 0.5723992586135864

--------------------------------------------------------------------------------------------------------
Overall Top-2 probability increase token counts at time step 1:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 9 , frequency: 1.000 , mean increase: 0.5723992586135864
Yes (dec: 'Yes'): count: 5 , frequency: 0.556 , mean increase: 0.03657020255923271
no (dec: 'no'): count: 4 , frequency: 0.444 , mean increase: 0.002799851819872856

--------------------------------------------------------------------------------------------------------
Overall Top-3 probability increase token counts at time step 1:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 9 , frequency: 1.000 , mean increase: 0.5723992586135864
I (dec: 'I'): count: 7 , frequency: 0.778 , mean increase: 0.0021331801544874907
no (dec: 'no'): count: 5 , frequency: 0.556 , mean increase: 0.002744420198723674
Yes (dec: 'Yes'): count: 5 , frequency: 0.556 , mean increase: 0.03657020255923271
NO (dec: 'NO'): count: 1 , frequency: 0.111 , mean increase: 0.00030949548818171024

--------------------------------------------------------------------------------------------------------
Overall Top-1 probability increase token counts at time step 5:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 9 , frequency: 1.000 , mean increase: 0.9107051491737366

--------------------------------------------------------------------------------------------------------
Overall Top-2 probability increase token counts at time step 5:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 9 , frequency: 1.000 , mean increase: 0.9107051491737366
no (dec: 'no'): count: 9 , frequency: 1.000 , mean increase: 0.015731021761894226

--------------------------------------------------------------------------------------------------------
Overall Top-3 probability increase token counts at time step 5:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 9 , frequency: 1.000 , mean increase: 0.9107051491737366
no (dec: 'no'): count: 9 , frequency: 1.000 , mean increase: 0.015731021761894226
NO (dec: 'NO'): count: 5 , frequency: 0.556 , mean increase: 0.00010406111687188968
Ġno (dec: ' no'): count: 4 , frequency: 0.444 , mean increase: 0.0003696242638397962

--------------------------------------------------------------------------------------------------------
Overall Top-1 probability increase token counts at time step 10:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 9 , frequency: 1.000 , mean increase: 0.8757666349411011

--------------------------------------------------------------------------------------------------------
Overall Top-2 probability increase token counts at time step 10:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 9 , frequency: 1.000 , mean increase: 0.8757666349411011
no (dec: 'no'): count: 9 , frequency: 1.000 , mean increase: 0.04930025339126587

--------------------------------------------------------------------------------------------------------
Overall Top-3 probability increase token counts at time step 10:
--------------------------------------------------------------------------------------------------------
Ġno (dec: ' no'): count: 9 , frequency: 1.000 , mean increase: 0.0014614529209211469
No (dec: 'No'): count: 9 , frequency: 1.000 , mean increase: 0.8757666349411011
no (dec: 'no'): count: 9 , frequency: 1.000 , mean increase: 0.04930025339126587

--------------------------------------------------------------------------------------------------------
Overall Top-1 probability increase token counts at time step 25:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 9 , frequency: 1.000 , mean increase: 0.8661788702011108

--------------------------------------------------------------------------------------------------------
Overall Top-2 probability increase token counts at time step 25:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 9 , frequency: 1.000 , mean increase: 0.8661788702011108
no (dec: 'no'): count: 9 , frequency: 1.000 , mean increase: 0.05263179540634155

--------------------------------------------------------------------------------------------------------
Overall Top-3 probability increase token counts at time step 25:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 9 , frequency: 1.000 , mean increase: 0.8661788702011108
no (dec: 'no'): count: 9 , frequency: 1.000 , mean increase: 0.05263179540634155
ĠNo (dec: ' No'): count: 5 , frequency: 0.556 , mean increase: 0.005527505185455084
Ġno (dec: ' no'): count: 4 , frequency: 0.444 , mean increase: 0.003243846818804741

--------------------------------------------------------------------------------------------------------
Overall Top-1 probability increase token counts at time step 50:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 9 , frequency: 1.000 , mean increase: 0.8806266188621521

--------------------------------------------------------------------------------------------------------
Overall Top-2 probability increase token counts at time step 50:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 9 , frequency: 1.000 , mean increase: 0.8806266188621521
no (dec: 'no'): count: 6 , frequency: 0.667 , mean increase: 0.03014747053384781
ĠNo (dec: ' No'): count: 3 , frequency: 0.333 , mean increase: 0.025678524747490883

--------------------------------------------------------------------------------------------------------
Overall Top-3 probability increase token counts at time step 50:
--------------------------------------------------------------------------------------------------------
ĠNo (dec: ' No'): count: 9 , frequency: 1.000 , mean increase: 0.019913693889975548
No (dec: 'No'): count: 9 , frequency: 1.000 , mean increase: 0.8806266188621521
no (dec: 'no'): count: 9 , frequency: 1.000 , mean increase: 0.024758581072092056

--------------------------------------------------------------------------------------------------------
Overall Top-1 probability increase token counts at time step 100:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 9 , frequency: 1.000 , mean increase: 0.8706406354904175

--------------------------------------------------------------------------------------------------------
Overall Top-2 probability increase token counts at time step 100:
--------------------------------------------------------------------------------------------------------
ĠNo (dec: ' No'): count: 9 , frequency: 1.000 , mean increase: 0.04836081340909004
No (dec: 'No'): count: 9 , frequency: 1.000 , mean increase: 0.8706406354904175

--------------------------------------------------------------------------------------------------------
Overall Top-3 probability increase token counts at time step 100:
--------------------------------------------------------------------------------------------------------
ĠNo (dec: ' No'): count: 9 , frequency: 1.000 , mean increase: 0.04836081340909004
No (dec: 'No'): count: 9 , frequency: 1.000 , mean increase: 0.8706406354904175
no (dec: 'no'): count: 9 , frequency: 1.000 , mean increase: 0.007485982496291399

========================================================================================================

========================================================================================================
Token unembeddings and hidden representation metrics:
--------------------------------------------------------------------------------------------------------
Preferred token norm: Initial: 2.150906562805176 , Final (mean): 2.1509687900543213
Dispreferred token norm: Initial: 2.318648099899292 , Final (mean): 2.318655490875244
Preferred and dispreferred inner product: Initial 1.1373040676116943 , Final (mean): 1.137153148651123
Dispreferred projection norm: Initial: 0.5287556648254395 , Final (mean): 0.5286701321601868
Preferred norm dispreferred projection norm diff: Initial: 1.6221508979797363 , Final (mean): 1.6222983598709106
Norm orthogonal component of dispreferred tokens: Initial: 2.2575531005859375 , Final (mean): 2.2575807571411133
Hidden representation norm mean: Initial: 45.253623962402344 , Final: 45.25185012817383
Hidden representation change norm mean: 46.23756408691406
