Filtered out 0 experiments in which the training loss increased at some time step
========================================================================================================
Experiment info outputs/persona/olmo1b_post_sft_ipo_no_vs_never:
--------------------------------------------------------------------------------------------------------
Model: allenai/OLMo-1B-hf
Model checkpoint: outputs/persona_models/olmo1b_sft_persona_cross_entropy_2025_12_15-19_17_03/model_epoch_0
Dataset: data_files/persona/ends-justify-means.jsonl
Preferred output token: 'No'
Dispreferred output token: 'Never'
========================================================================================================

========================================================================================================
Preferred output probability decrease results:
--------------------------------------------------------------------------------------------------------
First step preferred output probability decreased: Min: 24 , Max: 39 , Median: 32 , Mean: 31.700000762939453
--------------------------------------------------------------------------------------------------------
Number of examples in which preferred output probability decreased: 10 / 10
--------------------------------------------------------------------------------------------------------
Number of examples in which preferred output probability decreased and train loss decreased: 10 / 10
--------------------------------------------------------------------------------------------------------
Number of examples in which train loss INCREASED: 0 / 10
========================================================================================================

========================================================================================================
Max preferred output probability and log probability decrease results:
--------------------------------------------------------------------------------------------------------
Mean largest preferred output log probability decrease (step refers to value before that step): -0.04373509809374809 (-0.011199736967682838 -> -0.05493483692407608)
Mean start step: 31.700000762939453 , Mean end step: 100.0
--------------------------------------------------------------------------------------------------------
Mean largest preferred output probability decrease (step refers to value before that step): -0.042275138199329376 (0.988865077495575 -> 0.9465898275375366)
Mean start step: 31.700000762939453 , Mean end step: 100.0
========================================================================================================

========================================================================================================
Per example max preferred output probability and log probability decrease results
========================================================================================================
Example 0
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 35 to 100: -0.03429460525512695 (-0.008695602416992188 -> -0.04299020767211914)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 35 to 100: -0.03342127799987793 (0.9913420677185059 -> 0.9579207897186279)
========================================================================================================
Example 1
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 32 to 100: -0.034989118576049805 (-0.01294255256652832 -> -0.047931671142578125)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 32 to 100: -0.03394192457199097 (0.9871408343315125 -> 0.9531989097595215)
========================================================================================================
Example 2
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 34 to 100: -0.04649972915649414 (-0.01476597785949707 -> -0.06126570701599121)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 34 to 100: -0.044769227504730225 (0.9853425025939941 -> 0.9405732750892639)
========================================================================================================
Example 3
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 33 to 100: -0.04602646827697754 (-0.010440349578857422 -> -0.05646681785583496)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 33 to 100: -0.04451608657836914 (0.989613950252533 -> 0.9450978636741638)
========================================================================================================
Example 4
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 25 to 100: -0.04724693298339844 (-0.009974241256713867 -> -0.057221174240112305)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 25 to 100: -0.045690178871154785 (0.9900753498077393 -> 0.9443851709365845)
========================================================================================================
Example 5
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 39 to 100: -0.04550576210021973 (-0.012542247772216797 -> -0.05804800987243652)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 39 to 100: -0.043931424617767334 (0.9875360727310181 -> 0.9436046481132507)
========================================================================================================
Example 6
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 25 to 100: -0.05494427680969238 (-0.011078357696533203 -> -0.06602263450622559)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 25 to 100: -0.05287313461303711 (0.9889827966690063 -> 0.9361096620559692)
========================================================================================================
Example 7
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 39 to 100: -0.027126789093017578 (-0.0077936649322509766 -> -0.034920454025268555)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 39 to 100: -0.026554405689239502 (0.9922366142272949 -> 0.9656822085380554)
========================================================================================================
Example 8
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 31 to 100: -0.05213522911071777 (-0.013873100280761719 -> -0.06600832939147949)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 31 to 100: -0.05009961128234863 (0.9862226843833923 -> 0.9361230731010437)
========================================================================================================
Example 9
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 24 to 100: -0.04858207702636719 (-0.009891271591186523 -> -0.05847334861755371)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 24 to 100: -0.04695409536361694 (0.9901574850082397 -> 0.9432033896446228)
========================================================================================================


========================================================================================================
Tokens increasing most overall in probability:
--------------------------------------------------------------------------------------------------------
Overall Top-1 probability increase token counts at time step 1:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 10 , frequency: 1.000 , mean increase: 0.042354680597782135

--------------------------------------------------------------------------------------------------------
Overall Top-2 probability increase token counts at time step 1:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 10 , frequency: 1.000 , mean increase: 0.042354680597782135
Yes (dec: 'Yes'): count: 10 , frequency: 1.000 , mean increase: 0.019985651597380638

--------------------------------------------------------------------------------------------------------
Overall Top-3 probability increase token counts at time step 1:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 10 , frequency: 1.000 , mean increase: 0.042354680597782135
Yes (dec: 'Yes'): count: 10 , frequency: 1.000 , mean increase: 0.019985651597380638
Yeah (dec: 'Yeah'): count: 8 , frequency: 0.800 , mean increase: 0.008000794798135757
I (dec: 'I'): count: 2 , frequency: 0.200 , mean increase: 0.00020335044246166945

--------------------------------------------------------------------------------------------------------
Overall Top-1 probability increase token counts at time step 5:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 10 , frequency: 1.000 , mean increase: 0.27183836698532104

--------------------------------------------------------------------------------------------------------
Overall Top-2 probability increase token counts at time step 5:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 10 , frequency: 1.000 , mean increase: 0.27183836698532104
Yes (dec: 'Yes'): count: 9 , frequency: 0.900 , mean increase: 0.038380108773708344
no (dec: 'no'): count: 1 , frequency: 0.100 , mean increase: 0.0007036386523395777

--------------------------------------------------------------------------------------------------------
Overall Top-3 probability increase token counts at time step 5:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 10 , frequency: 1.000 , mean increase: 0.27183836698532104
no (dec: 'no'): count: 10 , frequency: 1.000 , mean increase: 0.0005539736594073474
Yes (dec: 'Yes'): count: 9 , frequency: 0.900 , mean increase: 0.038380108773708344
NO (dec: 'NO'): count: 1 , frequency: 0.100 , mean increase: 0.00011037057993235067

--------------------------------------------------------------------------------------------------------
Overall Top-1 probability increase token counts at time step 10:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 10 , frequency: 1.000 , mean increase: 0.6339682936668396

--------------------------------------------------------------------------------------------------------
Overall Top-2 probability increase token counts at time step 10:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 10 , frequency: 1.000 , mean increase: 0.6339682936668396
Yes (dec: 'Yes'): count: 6 , frequency: 0.600 , mean increase: 0.016654448583722115
no (dec: 'no'): count: 4 , frequency: 0.400 , mean increase: 0.0018259650096297264

--------------------------------------------------------------------------------------------------------
Overall Top-3 probability increase token counts at time step 10:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 10 , frequency: 1.000 , mean increase: 0.6339682936668396
no (dec: 'no'): count: 10 , frequency: 1.000 , mean increase: 0.0014201843878254294
Yes (dec: 'Yes'): count: 7 , frequency: 0.700 , mean increase: 0.014375033788383007
NO (dec: 'NO'): count: 3 , frequency: 0.300 , mean increase: 0.00012935245467815548

--------------------------------------------------------------------------------------------------------
Overall Top-1 probability increase token counts at time step 25:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 10 , frequency: 1.000 , mean increase: 0.9071897268295288

--------------------------------------------------------------------------------------------------------
Overall Top-2 probability increase token counts at time step 25:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 10 , frequency: 1.000 , mean increase: 0.9071897268295288
no (dec: 'no'): count: 10 , frequency: 1.000 , mean increase: 0.0058512301184237

--------------------------------------------------------------------------------------------------------
Overall Top-3 probability increase token counts at time step 25:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 10 , frequency: 1.000 , mean increase: 0.9071897268295288
no (dec: 'no'): count: 10 , frequency: 1.000 , mean increase: 0.0058512301184237
NO (dec: 'NO'): count: 10 , frequency: 1.000 , mean increase: 0.00018080687732435763

--------------------------------------------------------------------------------------------------------
Overall Top-1 probability increase token counts at time step 50:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 10 , frequency: 1.000 , mean increase: 0.9088188409805298

--------------------------------------------------------------------------------------------------------
Overall Top-2 probability increase token counts at time step 50:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 10 , frequency: 1.000 , mean increase: 0.9088188409805298
no (dec: 'no'): count: 10 , frequency: 1.000 , mean increase: 0.018464157357811928

--------------------------------------------------------------------------------------------------------
Overall Top-3 probability increase token counts at time step 50:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 10 , frequency: 1.000 , mean increase: 0.9088188409805298
no (dec: 'no'): count: 10 , frequency: 1.000 , mean increase: 0.018464157357811928
Ġno (dec: ' no'): count: 6 , frequency: 0.600 , mean increase: 0.00027087584021501243
NO (dec: 'NO'): count: 4 , frequency: 0.400 , mean increase: 0.00019883378990925848

--------------------------------------------------------------------------------------------------------
Overall Top-1 probability increase token counts at time step 100:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 10 , frequency: 1.000 , mean increase: 0.8746342658996582

--------------------------------------------------------------------------------------------------------
Overall Top-2 probability increase token counts at time step 100:
--------------------------------------------------------------------------------------------------------
No (dec: 'No'): count: 10 , frequency: 1.000 , mean increase: 0.8746342658996582
no (dec: 'no'): count: 10 , frequency: 1.000 , mean increase: 0.051589272916316986

--------------------------------------------------------------------------------------------------------
Overall Top-3 probability increase token counts at time step 100:
--------------------------------------------------------------------------------------------------------
Ġno (dec: ' no'): count: 10 , frequency: 1.000 , mean increase: 0.0014143132138997316
No (dec: 'No'): count: 10 , frequency: 1.000 , mean increase: 0.8746342658996582
no (dec: 'no'): count: 10 , frequency: 1.000 , mean increase: 0.051589272916316986

========================================================================================================

========================================================================================================
Token unembeddings and hidden representation metrics:
--------------------------------------------------------------------------------------------------------
Preferred token norm: Initial: 2.150906562805176 , Final (mean): 2.1509287357330322
Dispreferred token norm: Initial: 2.318648099899292 , Final (mean): 2.3186416625976562
Preferred and dispreferred inner product: Initial 1.1373040676116943 , Final (mean): 1.1372708082199097
Dispreferred projection norm: Initial: 0.5287556648254395 , Final (mean): 0.5287347435951233
Preferred norm dispreferred projection norm diff: Initial: 1.6221508979797363 , Final (mean): 1.6221940517425537
Norm orthogonal component of dispreferred tokens: Initial: 2.2575531005859375 , Final (mean): 2.257551431655884
Hidden representation norm mean: Initial: 45.253623962402344 , Final: 45.25236511230469
Hidden representation change norm mean: 32.50725173950195
