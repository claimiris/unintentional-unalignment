Filtered out 0 experiments in which the training loss increased at some time step
========================================================================================================
Experiment info outputs/persona/olmo1b_post_sft_ipo_yes_vs_no:
--------------------------------------------------------------------------------------------------------
Model: allenai/OLMo-1B-hf
Model checkpoint: outputs/persona_models/olmo1b_sft_persona_cross_entropy_2025_12_15-19_17_03/model_epoch_0
Dataset: data_files/persona/ends-justify-means.jsonl
Preferred output token: 'Yes'
Dispreferred output token: 'No'
========================================================================================================

========================================================================================================
Preferred output probability decrease results:
--------------------------------------------------------------------------------------------------------
First step preferred output probability decreased: Min: -1 , Max: -1 , Median: -1 , Mean: -1.0
--------------------------------------------------------------------------------------------------------
Number of examples in which preferred output probability decreased: 0 / 10
--------------------------------------------------------------------------------------------------------
Number of examples in which preferred output probability decreased and train loss decreased: 0 / 10
--------------------------------------------------------------------------------------------------------
Number of examples in which train loss INCREASED: 0 / 10
========================================================================================================

========================================================================================================
Max preferred output probability and log probability decrease results:
--------------------------------------------------------------------------------------------------------
Mean largest preferred output log probability decrease (step refers to value before that step): 0.0 (-1.9814975261688232 -> -1.9814975261688232)
Mean start step: 0.0 , Mean end step: 0.0
--------------------------------------------------------------------------------------------------------
Mean largest preferred output probability decrease (step refers to value before that step): 0.0 (0.13848552107810974 -> 0.13848552107810974)
Mean start step: 0.0 , Mean end step: 0.0
========================================================================================================

========================================================================================================
Per example max preferred output probability and log probability decrease results
========================================================================================================
Example 0
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 0 to 0: 0.0 (-1.979870080947876 -> -1.979870080947876)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 0 to 0: 0.0 (0.1380871683359146 -> 0.1380871683359146)
========================================================================================================
Example 1
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 0 to 0: 0.0 (-1.9426276683807373 -> -1.9426276683807373)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 0 to 0: 0.0 (0.14332683384418488 -> 0.14332683384418488)
========================================================================================================
Example 2
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 0 to 0: 0.0 (-2.095527172088623 -> -2.095527172088623)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 0 to 0: 0.0 (0.12300538271665573 -> 0.12300538271665573)
========================================================================================================
Example 3
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 0 to 0: 0.0 (-2.0252392292022705 -> -2.0252392292022705)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 0 to 0: 0.0 (0.13196226954460144 -> 0.13196226954460144)
========================================================================================================
Example 4
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 0 to 0: 0.0 (-1.923910140991211 -> -1.923910140991211)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 0 to 0: 0.0 (0.1460348218679428 -> 0.1460348218679428)
========================================================================================================
Example 5
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 0 to 0: 0.0 (-1.865237832069397 -> -1.865237832069397)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 0 to 0: 0.0 (0.15485937893390656 -> 0.15485937893390656)
========================================================================================================
Example 6
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 0 to 0: 0.0 (-1.8398566246032715 -> -1.8398566246032715)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 0 to 0: 0.0 (0.15884019434452057 -> 0.15884019434452057)
========================================================================================================
Example 7
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 0 to 0: 0.0 (-2.0111961364746094 -> -2.0111961364746094)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 0 to 0: 0.0 (0.13382850587368011 -> 0.13382850587368011)
========================================================================================================
Example 8
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 0 to 0: 0.0 (-2.1732406616210938 -> -2.1732406616210938)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 0 to 0: 0.0 (0.11380820721387863 -> 0.11380820721387863)
========================================================================================================
Example 9
--------------------------------------------------------------------------------------------------------
Largest preferred output log probability decrease (step refers to value before that step):
Step 0 to 0: 0.0 (-1.958269715309143 -> -1.958269715309143)
--------------------------------------------------------------------------------------------------------
Largest preferred output probability decrease (step refers to value before that step):
Step 0 to 0: 0.0 (0.1411023586988449 -> 0.1411023586988449)
========================================================================================================


========================================================================================================
Tokens increasing most overall in probability:
--------------------------------------------------------------------------------------------------------
Overall Top-1 probability increase token counts at time step 1:
--------------------------------------------------------------------------------------------------------
Yes (dec: 'Yes'): count: 10 , frequency: 1.000 , mean increase: 0.026635747402906418

--------------------------------------------------------------------------------------------------------
Overall Top-2 probability increase token counts at time step 1:
--------------------------------------------------------------------------------------------------------
Yes (dec: 'Yes'): count: 10 , frequency: 1.000 , mean increase: 0.026635747402906418
Sure (dec: 'Sure'): count: 8 , frequency: 0.800 , mean increase: 0.014681065455079079
Yeah (dec: 'Yeah'): count: 2 , frequency: 0.200 , mean increase: 0.015176236629486084

--------------------------------------------------------------------------------------------------------
Overall Top-3 probability increase token counts at time step 1:
--------------------------------------------------------------------------------------------------------
Yes (dec: 'Yes'): count: 10 , frequency: 1.000 , mean increase: 0.026635747402906418
Sure (dec: 'Sure'): count: 10 , frequency: 1.000 , mean increase: 0.014224505051970482
Certainly (dec: 'Certainly'): count: 6 , frequency: 0.600 , mean increase: 0.009418613277375698
Yeah (dec: 'Yeah'): count: 4 , frequency: 0.400 , mean increase: 0.011032301932573318

--------------------------------------------------------------------------------------------------------
Overall Top-1 probability increase token counts at time step 5:
--------------------------------------------------------------------------------------------------------
Yes (dec: 'Yes'): count: 10 , frequency: 1.000 , mean increase: 0.10703568160533905

--------------------------------------------------------------------------------------------------------
Overall Top-2 probability increase token counts at time step 5:
--------------------------------------------------------------------------------------------------------
Yes (dec: 'Yes'): count: 10 , frequency: 1.000 , mean increase: 0.10703568160533905
Certainly (dec: 'Certainly'): count: 9 , frequency: 0.900 , mean increase: 0.041605010628700256
Sure (dec: 'Sure'): count: 1 , frequency: 0.100 , mean increase: 0.03608494997024536

--------------------------------------------------------------------------------------------------------
Overall Top-3 probability increase token counts at time step 5:
--------------------------------------------------------------------------------------------------------
Yes (dec: 'Yes'): count: 10 , frequency: 1.000 , mean increase: 0.10703568160533905
Sure (dec: 'Sure'): count: 10 , frequency: 1.000 , mean increase: 0.03426728770136833
Certainly (dec: 'Certainly'): count: 10 , frequency: 1.000 , mean increase: 0.04069049656391144

--------------------------------------------------------------------------------------------------------
Overall Top-1 probability increase token counts at time step 10:
--------------------------------------------------------------------------------------------------------
Yes (dec: 'Yes'): count: 10 , frequency: 1.000 , mean increase: 0.22451718151569366

--------------------------------------------------------------------------------------------------------
Overall Top-2 probability increase token counts at time step 10:
--------------------------------------------------------------------------------------------------------
Yes (dec: 'Yes'): count: 10 , frequency: 1.000 , mean increase: 0.22451718151569366
Certainly (dec: 'Certainly'): count: 10 , frequency: 1.000 , mean increase: 0.05247637629508972

--------------------------------------------------------------------------------------------------------
Overall Top-3 probability increase token counts at time step 10:
--------------------------------------------------------------------------------------------------------
Yes (dec: 'Yes'): count: 10 , frequency: 1.000 , mean increase: 0.22451718151569366
Sure (dec: 'Sure'): count: 10 , frequency: 1.000 , mean increase: 0.01804344356060028
Certainly (dec: 'Certainly'): count: 10 , frequency: 1.000 , mean increase: 0.05247637629508972

--------------------------------------------------------------------------------------------------------
Overall Top-1 probability increase token counts at time step 25:
--------------------------------------------------------------------------------------------------------
Yes (dec: 'Yes'): count: 10 , frequency: 1.000 , mean increase: 0.5987305045127869

--------------------------------------------------------------------------------------------------------
Overall Top-2 probability increase token counts at time step 25:
--------------------------------------------------------------------------------------------------------
Yes (dec: 'Yes'): count: 10 , frequency: 1.000 , mean increase: 0.5987305045127869
YES (dec: 'YES'): count: 10 , frequency: 1.000 , mean increase: 0.001149857067503035

--------------------------------------------------------------------------------------------------------
Overall Top-3 probability increase token counts at time step 25:
--------------------------------------------------------------------------------------------------------
Yes (dec: 'Yes'): count: 10 , frequency: 1.000 , mean increase: 0.5987305045127869
yes (dec: 'yes'): count: 10 , frequency: 1.000 , mean increase: 0.0005480714607983828
YES (dec: 'YES'): count: 10 , frequency: 1.000 , mean increase: 0.001149857067503035

--------------------------------------------------------------------------------------------------------
Overall Top-1 probability increase token counts at time step 50:
--------------------------------------------------------------------------------------------------------
Yes (dec: 'Yes'): count: 10 , frequency: 1.000 , mean increase: 0.753555417060852

--------------------------------------------------------------------------------------------------------
Overall Top-2 probability increase token counts at time step 50:
--------------------------------------------------------------------------------------------------------
Yes (dec: 'Yes'): count: 10 , frequency: 1.000 , mean increase: 0.753555417060852
YES (dec: 'YES'): count: 10 , frequency: 1.000 , mean increase: 0.001108153024688363

--------------------------------------------------------------------------------------------------------
Overall Top-3 probability increase token counts at time step 50:
--------------------------------------------------------------------------------------------------------
Yes (dec: 'Yes'): count: 10 , frequency: 1.000 , mean increase: 0.753555417060852
YES (dec: 'YES'): count: 10 , frequency: 1.000 , mean increase: 0.001108153024688363
yes (dec: 'yes'): count: 9 , frequency: 0.900 , mean increase: 0.0005117789260111749
Yep (dec: 'Yep'): count: 1 , frequency: 0.100 , mean increase: 0.0006022886373102665

--------------------------------------------------------------------------------------------------------
Overall Top-1 probability increase token counts at time step 100:
--------------------------------------------------------------------------------------------------------
Yes (dec: 'Yes'): count: 10 , frequency: 1.000 , mean increase: 0.8245759010314941

--------------------------------------------------------------------------------------------------------
Overall Top-2 probability increase token counts at time step 100:
--------------------------------------------------------------------------------------------------------
Yes (dec: 'Yes'): count: 10 , frequency: 1.000 , mean increase: 0.8245759010314941
YES (dec: 'YES'): count: 6 , frequency: 0.600 , mean increase: 0.0013393353438004851
yes (dec: 'yes'): count: 4 , frequency: 0.400 , mean increase: 0.001692521502263844

--------------------------------------------------------------------------------------------------------
Overall Top-3 probability increase token counts at time step 100:
--------------------------------------------------------------------------------------------------------
Yes (dec: 'Yes'): count: 10 , frequency: 1.000 , mean increase: 0.8245759010314941
yes (dec: 'yes'): count: 10 , frequency: 1.000 , mean increase: 0.0013785515911877155
YES (dec: 'YES'): count: 10 , frequency: 1.000 , mean increase: 0.0012512693647295237

========================================================================================================

========================================================================================================
Token unembeddings and hidden representation metrics:
--------------------------------------------------------------------------------------------------------
Preferred token norm: Initial: 2.3055412769317627 , Final (mean): 2.305558443069458
Dispreferred token norm: Initial: 2.150906562805176 , Final (mean): 2.1509013175964355
Preferred and dispreferred inner product: Initial 1.7760987281799316 , Final (mean): 1.7760705947875977
Dispreferred projection norm: Initial: 0.7703608274459839 , Final (mean): 0.7703429460525513
Preferred norm dispreferred projection norm diff: Initial: 1.5351804494857788 , Final (mean): 1.5352153778076172
Norm orthogonal component of dispreferred tokens: Initial: 2.008218765258789 , Final (mean): 2.0082201957702637
Hidden representation norm mean: Initial: 45.25367736816406 , Final: 45.25211715698242
Hidden representation change norm mean: 33.538108825683594
